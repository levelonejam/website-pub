<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:video" content="https://www.youtube.com/v/">
<title></title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
<link rel="stylesheet" href="main.css">
<link rel="stylesheet" href="overwrite.css">
<script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
<script src="https://www.youtube.com/player_api"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/10.0.0/markdown-it.min.js" integrity="sha256-YASERpEeN8gRNr/Fy4Km34WGFqIq1h6HkJMAQnVHlhk=" crossorigin="anonymous"></script>


<script type="text/javascript" src="/js/settingsHandler.js"></script>
<script type="text/javascript" src="/js/util.js"></script>
<script type="text/javascript" src="/js/timer.js"></script>
<script type="text/javascript" src="/js/eventCountdown.js"></script>
<script type="text/javascript" src="/js/announcement.js"></script>
<script type="text/javascript" src="/js/pointer.js"></script>
<script type="text/javascript" src="/js/tab.js"></script>
<script type="text/javascript" src="/js/video.js"></script>
<script type="text/javascript" src="/js/init.js"></script>
<script type="text/javascript" src="data2020.json"></script>


<meta property="og:title" content="" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="" />



  <meta http-equiv="refresh" content="5; url=/">
  </head>
  <body>
  

  
	<script>setOption( 0 ,{"name":"Level One Jam","themeURL":"https://raw.githubusercontent.com/BlackPhlox/level-one-jam-theme-announcement/master/theme2020.txt","videoId":"_2BVvSVlDF0"});</script>


<script>setCountdownText();</script>
<script>
	
function leadingZeroDateFormat(date){
	const newdate = ('0' + date.getDate()).slice(-2) + '-'
	+ ('0' + (date.getMonth()+1)).slice(-2) + '-'
	+ date.getFullYear();
	return newdate;
}

const md = window.markdownit();

function FirstNonEmptyArray(object) {
  for (var property in object) {
    if (object.hasOwnProperty(property) && (object[property] instanceof Array)) {
      if (object[property].length > 0) {return property;}
  }
}};



async function getSheetAllAsync(){
  let response = await fetch(`https:${"//"}sheets.googleapis.com/v4/spreadsheets/1hTdx5d5gzByh7cp6RPoDjp2MbdZ6ViyB4Z5iupA2Q9A/values/${"A"}:${"AC"}?dateTimeRenderOption=FORMATTED_STRING&majorDimension=DIMENSION_UNSPECIFIED&valueRenderOption=UNFORMATTED_VALUE&key=AIzaSyCqY0hb2ShiHFhGabBUc1arzKDLmYW0ktk`);
  let data = response.json();
  return data;
}

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function splitSheetLocal(){
  let categories = await JSON.parse(test);
  await sleep(100);
  return categories;
}

async function splitSheet(){
  let data = await getSheetAllAsync();
  let raw = data.values;
  let categories = [];
  let cells = 0;
  let prevCategory;
  let index = 0;
  raw[0].forEach(str => {
    if(str.length > 0) {
      categories.push({"Category" : prevCategory,"Cells":cells,"from":(index-cells),"to":index});
      cells = 0;
      prevCategory = str;
    } else {
      cells++;
    }
    index++;
  })

  categories.shift(); 

  categories.forEach(c => {
    let data = [];
    for(let i = 1; i < raw.length; i++){
      let temp = [];
      for(let j = c.from; j < c.to; j++){
        temp.push(raw[i][j]);
      }
      data.push(temp);
    }
    c["raw"] = data;
  })
  
  categories.forEach(c => {
    let arr = [];
    c.raw.forEach(e => {
      let keys = c.raw[0];
      if(keys === e) return;
      let temp = {};
      for(let i = 0; i < keys.length; i++){
        temp[keys[i]] = e[i];
      }
      arr.push(temp);
    });
    c["data"] = arr;
  });

  return categories;
}

let textData;
splitSheetLocal().then(data => {textData = data});


async function getAnnouncements(){
  if (textData === undefined) textData = await splitSheetLocal();
  return textData.filter(e => e.Category == "Announcements")[0]
}

async function getProgram(){
  if (textData === undefined) textData = await splitSheetLocal();
  return textData.filter(e => e.Category == "Program")[0]
}

async function getFAQ(){
  if (textData === undefined) textData = await splitSheetLocal();
  return textData.filter(e => e.Category == "FAQ")[0]
}

async function getRules(){
  if (textData === undefined) textData = await splitSheetLocal();
  return textData.filter(e => e.Category == "Rules")[0]
}

async function getAchievements(){
  if (textData === undefined) textData = await splitSheetLocal();
  return textData.filter(e => e.Category == "Achievements")[0]
}

getAnnouncements()
  .then(arr => {
    arr.data.forEach(a => {
      if(a.include) addAnnouncement(a.include,a.name,a.date,a.msg,a.rel,a.relData);
    });
  })
  .then(() => initProgram());

getProgram()
	.then(arr => {
	arr.data.forEach(a => {
		a.day = a.day.toLowerCase();
		generateProgramContent(a.day,a);
	})
}).then(() => {
    const tarr = tabs.filter(t => t.id === "programTabs")[0].tabs;
	  switchTab("programTabs", tarr[0]);
})
  
getFAQ()
	.then(arr => {
	arr.data.forEach(a => {
		generateFAQContent(a);
	})
}).then(() => {
    const tarr = tabs.filter(t => t.id === "infoTabs")[0].tabs;
    switchTab("infoTabs", tarr[0]);
})

getRules()
	.then(arr => {
	arr.data.forEach(a => {
		generateRulesContent(a);
	})
})

function onlyUnique(value, index, self) { 
    return self.indexOf(value) === index;
}
  
getAchievements()
	.then(arr => {
		let categories = [];
		arr.data.filter(d => d.by !== '').forEach(c => {
      if(!c.include) return;
			if(!categories.map(d => d.by).includes(c.by)) categories.push({by:c.by,categoryname:c.categoryname,reward:c.reward})
		});

		categories.forEach(c => {
			arr.data.forEach(d => {				
				if(c.by == d.by) {
					if(c.data === undefined) c["data"] = Array.of(d);
					else c.data.push(d);
				}
			})
		})

		categories.forEach(c => {
			generateTab("achievementTabs",c.categoryname);
			
			let wrapper = document.getElementById("achievementContent");

       
			let header = document.createElement("div");
      
      header.classList.add("is-centered");
      header.classList.add("columns");
      header.classList.add("is-mobile");

			let fig = document.createElement("figure");
			fig.classList.add("image");
			fig.classList.add("is-128x128");

			let image = document.createElement("img");
			image.classList.add("is-rounded");
			image.src = c.reward;
			fig.appendChild(image);

      let titleWrap = document.createElement("div");

      let title = document.createElement("strong");
      title.classList.add("is-size-4");
      title.classList.add("is-multiline");
      title.classList.add("column");
      title.innerHTML = replaceAll(c.categoryname,"_"," ");

      let byline = document.createElement("span");
      byline.innerHTML = md.render(`By: [${c.by}](#sponsors)`);
      byline.setAttribute("style","font-size:18px");

      let disc = document.createElement("h5");
      disc.innerHTML = md.render(`Complete all three achievements below\n\n to earn the _${replaceAll(c.categoryname,"_"," ")}_ sticker`);
      disc.classList.add("is-size-6");

      titleWrap.appendChild(title);
      title.appendChild(document.createElement("br"));
      title.appendChild(byline);
      title.appendChild(document.createElement("br"));
      title.appendChild(disc);
      titleWrap.classList.add("columns");
      titleWrap.classList.add("has-text-right");
      titleWrap.setAttribute("style","margin-top:12px;margin-right:12px");
       

      header.appendChild(titleWrap);
      header.appendChild(fig);

			let content = document.createElement("div");
			content.setAttribute("id", `${c.categoryname.toLowerCase()}`);

      content.append(header);
			
			wrapper.appendChild(content);

			if(c.dom === undefined) c["dom"] = Array.of(content);
			else c.dom.push(content);
		});

    generateAchievements(categories);
    
    if(document.location.hash.startsWith("#achievements")){
      document.location.hash = "#practical"
      switchTab('infoTabs','achievements');
    }
})

function generateProgramContent(name,data){

  
  let daydiv = document.createElement("div");

  
  let div01 = document.createElement("div");
  div01.classList.add("columns")
  div01.classList.add("is-mobile")
  div01.classList.add("is-multiline");
  
  
  let div02 = document.createElement("div");
  div02.classList.add("column");
  div02.classList.add("is-one-fifth");

  let span01 = document.createElement("span");
  span01.classList.add("tag");
  span01.classList.add("is-dark");
  span01.innerHTML = data.time;

  div02.appendChild(span01);
  
  
  let div03 = document.createElement("div");
  div03.classList.add("column");
  div03.classList.add("is-four-fifths-mobile");
  div03.classList.add("is-one-third-desktop");
  div03.innerHTML = data.name;

  
  let div04 = document.createElement("div");
  div04.classList.add("column");
  div04.classList.add("is-flex-mobile");
  div04.innerHTML = md.render(data.desc);

  let fig = document.createElement("figure");
  fig.classList.add("column");
  fig.classList.add("image");

  let image = document.createElement("img");
  image.src = data.img;
  if(data.img) image.setAttribute("style","width:300px");
  fig.appendChild(image);

  
  let i0 = document.createElement("i");
  div04.appendChild(i0);
  
  div01.appendChild(div02);
  div01.appendChild(div03);
  div01.appendChild(div04);
  div01.appendChild(fig);

  daydiv.appendChild(div01);
  
  let content = document.getElementById(name);
  if(content == null) return;
  content.appendChild(daydiv);
}

function generateRulesContent(data){
  if(data.rule === undefined) return;
  let faq = document.createElement("div");
  faq.classList.add("column");
  faq.classList.add("is-half");

  let spacer = document.createElement("strong");
  let question = document.createElement("strong");
  question.innerHTML = md.render(data.headline);

  let answer = document.createElement("p");
  answer.innerHTML = md.render(data.rule);

  let brk = document.createElement("br");

  faq.appendChild(spacer);
  faq.appendChild(question);
  faq.appendChild(answer);
  faq.appendChild(brk);

  let content = document.getElementById("rules");
  content.appendChild(faq);
}

function generateFAQContent(data){
  if(data.q === undefined || data.q === '') return;
  let faq = document.createElement("div");
  faq.classList.add("column");
  faq.classList.add("is-half");

  let spacer = document.createElement("strong");
  let question = document.createElement("strong");
  question.innerHTML = md.render(data.q);

  let answer = document.createElement("p");
  answer.innerHTML = md.render(data.a);

  let brk = document.createElement("br");

  faq.appendChild(spacer);
  faq.appendChild(question);
  faq.appendChild(answer);
  faq.appendChild(brk);

  let content = document.getElementById("faq");
  content.appendChild(faq);


}

function generateAchievements(categories){

	categories.forEach(c => {
		let contentWrap = document.createElement("div");

		c.data.forEach(data => {
			let wrapper = document.createElement("div");
			
      contentWrap.classList.add("columns");
      contentWrap.classList.add("is-centered");

			let textWrap = document.createElement("div");
			textWrap.classList.add("column");
			textWrap.classList.add("is-one-third");

			let titleWrap = document.createElement("div");
			let title = document.createElement("strong");
			title.classList.add("is-size-4");
			title.innerHTML = data.name;

			let disc = document.createElement("div");
			disc.innerHTML = md.render(`**Achieved by:** \n\n${data.achievedby}`);

			titleWrap.appendChild(title);
			textWrap.appendChild(titleWrap);
			textWrap.appendChild(disc);

			contentWrap.appendChild(textWrap);

			let imgWrap = document.createElement("div");
			imgWrap.classList.add("column");

			let fig = document.createElement("figure");
			fig.classList.add("image");
			fig.classList.add("is-128x128");

			let image = document.createElement("img");
			image.classList.add("is-rounded");
			image.src = data.img;

			fig.appendChild(image);
			imgWrap.appendChild(fig);

			
		})

		c.dom[0].appendChild(contentWrap);
	});	
	
  let tarr = tabs.filter(t => t.id === "achievementTabs")[0];
  if(tarr === undefined) return;
  else tarr = tarr.tabs;
	
	switchTab("achievementTabs", tarr[0]);
}

</script>



  
  <noscript>
	<div style="padding: 5px; color: black;background-color: #ffd000; text-align: center;">
		
	</div>
</noscript>
<section class="section">
	<div class="container">			
		<div class="columns">
			<div class="column">
				<figure class="image is-256x256" style="padding-bottom: 20px">
					<a class="logo" href="#" ><img src="/loj_logo.png"></a>
				</figure>
				<p>Announcement:</p>
				<p class="is-size-5" id="announcementText"></p>
			</div>			
			<div class="column has-text-right">
				<script>document.write(`<p class="is-size-6" id = "countdowntext"></p>`);</script>
				<noscript>
					<p class="is-size-6">  </p>
				</noscript>
				<script>document.write(`<p class="is-size-5"><strong><time id="countdown"> Loading countdown... </time></strong></p>`);</script>
				<noscript>
					<p class="is-size-5" ><strong><time>  </time></strong></p>
				</noscript>
				<p><i></i></p>
				<br>
				
				<a href= class="button is-link is-outlined">Apply for Volunteering</a>
			</div>
		</div>
		<div>
			<p class="is-size-5 has-text-weight-bold has-text-centered" id="themeAnnouncementSubtext"></p>
			<p class="themeText is-size-1 has-text-weight-bold has-text-centered" id="themeAnnouncement"></p>
		</div>
	</div>
</section>

  <section class="hero is-danger is-medium">
  <div class="hero-body">
    <div class="container has-text-centered">
  		<h2 class="title">404 - Page not found👽</h2>
  		<p class="subtitle">Sending you back to the homepage ...</p> 
  	</div>
  </div>
  </section>
 
  
  <footer class="footer has-background-grey-darker has-text-grey-light">
  <div class="container">
    <div class="columns">
      <div class="column is-one-third">
        <p>
          
        </p>
      </div>
      <div class="column is-one-third">
      </div>
      <div class="column is-one-third">
        <figure class="image">
          <a class="logo" href="https://en.itu.dk/"><img src="/ITU_logo_UK.jpg"></a>
        </figure>
      </div>
    </div>
    <p class="has-text-centered has-text-grey-dark">Level One Jam © 2018-2021</p>    
  </div>
</footer>
  </body>
</html>